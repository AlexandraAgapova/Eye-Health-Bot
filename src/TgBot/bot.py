import telebot
import os
import random
from classifier.classifier import Classifier
from classifier.classifier import models_

model_orchesre = Classifier(models_)

bot = telebot.TeleBot("TOKEN NAME")
helloVarious = {"–ø—Ä–∏–≤–µ—Ç", "–ü—Ä–∏–≤–µ—Ç", "–∑–¥–∞—Ä–æ–≤–∞", "–ø—Ä–∏–≤–µ—Ç–∏–∫", "–ü—Ä–∏–≤–µ—Ç–∏–∫", "–ó–¥–∞—Ä–æ–≤–∞"}
DATA_DIR = "../../data"

@bot.message_handler(commands=["start"])
def start_message(message):
    bot.send_message(
        message.chat.id,
        "–ü—Ä–∏–≤–µ—Ç! üëã\n\n"
        "–î–∞–≤–∞–π—Ç–µ —è –ø–æ–º–æ–≥—É –í–∞–º –ø–æ–Ω—è—Ç—å, –µ—Å—Ç—å –ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –≤ –æ–±–ª–∞—Å—Ç–∏ –≥–ª–∞–∑, –∏ –¥–∞–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ üëÅ‚ú®\n\n"
        "üì∏ –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —á—ë—Ç–∫–æ–µ —Ñ–æ—Ç–æ –í–∞—à–µ–≥–æ –ª–∏—Ü–∞ –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –æ—Å–≤–µ—â–µ–Ω–∏–∏ ‚Äî —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç —Ç–æ—á–Ω–µ–µ –ø—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑."
    )


@bot.message_handler(content_types=["text"])
def get_text_messages(message):
    if message.text in helloVarious:
        bot.send_message(message.from_user.id, "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! üòä üì∏ –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —á—ë—Ç–∫–æ–µ —Ñ–æ—Ç–æ –í–∞—à–µ–≥–æ –ª–∏—Ü–∞ –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –æ—Å–≤–µ—â–µ–Ω–∏–∏, –∏ —è –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å –ø–æ–º–æ—á—å üëÅ")
    elif message.text == "/help":
        bot.send_message(
            message.from_user.id,
            "–û—Ç–ø—Ä–∞–≤—å—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –í–∞—à–µ–≥–æ –ª–∏—Ü–∞ –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –æ—Å–≤–µ—â–µ–Ω–∏–∏ üì∏ ‚Äî —è –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –æ–±–ª–∞—Å—Ç—å –≥–ª–∞–∑ –∏ –¥–∞–º –ø–æ–ª–µ–∑–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ üí°",
        )
    else:
        bot.send_message(message.from_user.id, "–ò–∑–≤–∏–Ω–∏—Ç–µ, —è –í–∞—Å –Ω–µ –ø–æ–Ω—è–ª üòï –ù–∞–ø–∏—à–∏—Ç–µ /help –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Å–∫–∞–∑–∫–∏.")

@bot.message_handler(content_types=["photo"])
def download_photo(message):
    user_id = message.from_user.id
    file_info = bot.get_file(message.photo[-1].file_id)
    downloaded_file = bot.download_file(file_info.file_path)

    filename = f"{user_id}.jpg"
    file_path = os.path.join(DATA_DIR, filename)

    with open(file_path, "wb") as new_file:
        new_file.write(downloaded_file)

    prediction = model_orchesre.predict(file_path)

    responses = {
        -1: [
            "üòû –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –ª–∏—Ü–æ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç—å –±–æ–ª–µ–µ —á—ë—Ç–∫–æ–µ —Ñ–æ—Ç–æ üì∑",
            "ü§ñ –ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ª–∏—Ü–æ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –¥—Ä—É–≥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ —Å —Ö–æ—Ä–æ—à–∏–º –æ—Å–≤–µ—â–µ–Ω–∏–µ–º üí°",
            "üì∏ –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ª–∏—Ü–æ —Ö–æ—Ä–æ—à–æ –≤–∏–¥–Ω–æ –∏ –Ω–µ –∑–∞–∫—Ä—ã—Ç–æ –≤–æ–ª–æ—Å–∞–º–∏ –∏–ª–∏ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏ üôà",
        ],
        0: [
            "üéâ –û—Ç–ª–∏—á–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏! –û–±–ª–∞—Å—Ç—å –≥–ª–∞–∑ –≤—ã–≥–ª—è–¥–∏—Ç –∑–¥–æ—Ä–æ–≤–æ–π üëÅ‚ú® –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ —Å–µ–±–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ä–µ–∂–∏–º —Å–Ω–∞ üò¥",
            "‚úÖ –í—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ! –ù–∏–∫–∞–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø—Ä–æ–±–ª–µ–º –≤ –æ–±–ª–∞—Å—Ç–∏ –≥–ª–∞–∑ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ üí™ –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —ç—Ç–æ—Ç –±–∞–ª–∞–Ω—Å ‚öñÔ∏è",
            "üåû –í–∞—à–∏ –≥–ª–∞–∑–∞ –≤—ã–≥–ª—è–¥—è—Ç —Ö–æ—Ä–æ—à–æ. –†–µ–≥—É–ª—è—Ä–Ω—ã–π –æ—Ç–¥—ã—Ö –∏ –∑–∞–±–æ—Ç–∞ –æ —Å–µ–±–µ –¥–∞—é—Ç –æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç üíö",
        ],
        1: [
            "üõå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–µ–±–æ–ª—å—à–∏–µ –º–µ—à–∫–∏ –ø–æ–¥ –≥–ª–∞–∑–∞–º–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å –Ω–µ–¥–æ—Å—ã–ø–æ–º –∏–ª–∏ –∑–∞–¥–µ—Ä–∂–∫–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏ üíß –ü–æ—Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å –±–æ–ª—å—à–µ –æ—Ç–¥—ã—Ö–∞—Ç—å üåô",
            "üòî –õ—ë–≥–∫–∞—è –æ—Ç—ë—á–Ω–æ—Å—Ç—å –ø–æ–¥ –≥–ª–∞–∑–∞–º–∏ –∑–∞–º–µ—á–µ–Ω–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —É–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞ –∏ –∏–∑–±–µ–≥–∞—Ç—å –ø–µ—Ä–µ—É—Ç–æ–º–ª–µ–Ω–∏—è üí§",
            "üìâ –ù–µ–±–æ–ª—å—à–∞—è –æ—Ç—ë—á–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–º —É—Å—Ç–∞–ª–æ—Å—Ç–∏. –£–¥–µ–ª—è–π—Ç–µ —Å–Ω—É –Ω–µ –º–µ–Ω–µ–µ 7-8 —á–∞—Å–æ–≤ üïê",
        ],
        2: [
            "üòì –¢—ë–º–Ω—ã–µ –∫—Ä—É–≥–∏ –ø–æ–¥ –≥–ª–∞–∑–∞–º–∏ –º–æ–≥—É—Ç –≥–æ–≤–æ—Ä–∏—Ç—å –æ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–ª–æ—Å—Ç–∏ –∏–ª–∏ —Å—Ç—Ä–µ—Å—Å–µ ‚ö†Ô∏è –ü–æ—Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–∂–∏–º —Å–Ω–∞ –∏ –æ—Ç–¥—ã—Ö–∞ üõè",
            "üß† –ó–∞–º–µ—á–µ–Ω—ã —Ç—ë–º–Ω—ã–µ –∫—Ä—É–≥–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∏–≥–Ω–∞–ª–æ–º, —á—Ç–æ –æ—Ä–≥–∞–Ω–∏–∑–º—É –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –æ—Ç–¥—ã—Ö–∞ –∏ –≤–∏—Ç–∞–º–∏–Ω–æ–≤ üíä",
            "üí§ –ü—Ä–∏–∑–Ω–∞–∫–∏ —É—Ç–æ–º–ª–µ–Ω–∏—è –ø–æ–¥ –≥–ª–∞–∑–∞–º–∏. –°—Ç–∞—Ä–∞–π—Ç–µ—Å—å –æ—Ç–¥—ã—Ö–∞—Ç—å –∏ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å —ç–∫—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥ —Å–Ω–æ–º üìµ",
        ],
        3: [
            "üò• –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏ —Ç—ë–º–Ω—ã–µ –∫—Ä—É–≥–∏, –∏ –º–µ—à–∫–∏ –ø–æ–¥ –≥–ª–∞–∑–∞–º–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ø–µ—Ä–µ—É—Ç–æ–º–ª–µ–Ω–∏—è üòì –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–µ–∂–∏–º —Å–Ω–∞ –∏ —Å–Ω–∏–∑—å—Ç–µ —Å—Ç—Ä–µ—Å—Å üåø",
            "‚ö†Ô∏è –í—ã—Ä–∞–∂–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —É—Å—Ç–∞–ª–æ—Å—Ç–∏ –≤–æ–∫—Ä—É–≥ –≥–ª–∞–∑. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞–ª–∞–¥–∏—Ç—å —Ä–µ–∂–∏–º –¥–Ω—è –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É üßë‚Äç‚öïÔ∏è",
            "üòî –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –º–µ—à–∫–∏ –∏ —Ç—ë–º–Ω—ã–µ –∫—Ä—É–≥–∏. –ó–∞–±–æ—Ç–∞ –æ —Å–µ–±–µ ‚Äî —ç—Ç–æ –≤–∞–∂–Ω–æ ‚ù§Ô∏è –ü–æ—Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å –≤—ã—Å—ã–ø–∞—Ç—å—Å—è, –≥—É–ª—è—Ç—å –∏ —Å–Ω–∏–∑–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–µ—Å—Å–∞ üå∏",
        ],
    }

    reply = random.choice(responses.get(prediction, ["‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."]))
    bot.send_message(user_id, reply)

bot.polling(none_stop=True, interval=0)
